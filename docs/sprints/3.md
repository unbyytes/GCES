# üìù Relat√≥rio de Contribui√ß√£o ‚Äì Sprint 2

**Disciplina:** Gest√£o de Configura√ß√£o e Evolu√ß√£o de Software

**Equipe:** OWASP (Times Blue e Red)

**Per√≠odo da Sprint:** 07/10/2025 - 22/10/2025

---

## 1. Objetivos da Sprint

#### Blue Team

**Sele√ß√£o do Arsenal de Seguran√ßa e In√≠cio da Implementa√ß√£o de DevSecOps**

* Realizar uma pesquisa comparativa de ferramentas de seguran√ßa *open-source* nas categorias: **Detec√ß√£o de Segredos, An√°lise Est√°tica (SAST), An√°lise de Depend√™ncias (SCA) e Infraestrutura como C√≥digo (IaC)**.
* Selecionar o "arsenal" de ferramentas ideal para o projeto EJ-Platform, justificando a escolha do conjunto com base em crit√©rios de complementaridade, performance e adequa√ß√£o ao projeto.
* Integrar a primeira ferramenta de seguran√ßa selecionada ao pipeline de CI/CD no GitLab, configurando um novo *job* e validando a sua execu√ß√£o autom√°tica a cada `push`.
* Documentar todo o processo de pesquisa e a decis√£o final em um relat√≥rio consolidado.
  
### Red Team

- Explorar ataques sobre o EJ (Red Team): SQL Injection, CSRF, XSS e Clickjacking
- Estudar sobre:
    - IDOR
    - Sess√µes / Cookies inseguros
    - Brute force / Rate limiting

---

## 2. Entregas Coletivas

| Entrega                                                             | Status (Conclu√≠do/Parcial/Pendente) | Link/Refer√™ncia        | Observa√ß√µes                       |
| ------------------------------------------------------------------- | ----------------------------------- | ---------------------- | --------------------------------- |
| An√°lise da Plataforma sobre SQL Injection, XSS, CSRF e Clickjacking | Conclu√≠do                           |                        |                                   |
| Estudo e Implementa√ß√£o de Ferramentas de Seguran√ßa no CI/CD         | Conclu√≠do                           |                        | Gitleaks e Bandit testados        |

---

## 3. Contribui√ß√µes Individuais

| Integrante        | Contribui√ß√µes                             | Links (PRs, Issues, Docs) | Observa√ß√µes |
| ----------------- | ----------------------------------------- | ------------------------- | ----------- |
| Miguel Arthur     | Documenta√ß√£o e Tabela Comparativa  | [()](link) |             |
| Daniel Rocha     | Documenta√ß√£o e Resultados Parciais da Utiliza√ß√£o do GitLeaks na pipeline do projeto, al√©m dos testes locais utilizando o gitleaks  | [Di√°rio Daniel](../diarios/190104821/sprint_3_diario.md) |   Os resultados podem ser vistos na aba **Exemplos pr√°ticos**          |
| Ana Carolina     | An√°lise de depend√™ncias com pip-audit | [Pipeline pip-audit](https://gitlab.com/caroll_mf/ej-application/-/commit/3f749028) | Pipeline focada em seguran√ßa de depend√™ncias |


---

## 4. Maiores Avan√ßos

### Blue Team

### Pesquisa e Sele√ß√£o do Arsenal de Seguran√ßa

Dando continuidade ao plano de implementa√ß√£o de um pipeline de DevSecOps, o objetivo desta sprint foi realizar uma pesquisa aprofundada para selecionar o conjunto ideal de ferramentas de seguran√ßa para o projeto EJ-Platform.

A metodologia consistiu em dividir a pesquisa em quatro categorias essenciais, visando criar uma estrat√©gia de **defesa em camadas**, onde cada ferramenta possui uma responsabilidade clara e complementar:

1.  **Detec√ß√£o de Segredos:** Prevenir o vazamento de credenciais e chaves de API.
2.  **An√°lise Est√°tica de Seguran√ßa (SAST):** Encontrar vulnerabilidades no c√≥digo-fonte da aplica√ß√£o.
3.  **An√°lise de Composi√ß√£o de Software (SCA):** Identificar vulnerabilidades em depend√™ncias de terceiros.
4.  **Seguran√ßa de Infraestrutura como C√≥digo (IaC):** Garantir que a configura√ß√£o dos nossos cont√™ineres (`Dockerfile`) segue as boas pr√°ticas de seguran√ßa.


### Ferramentas de Seguran√ßa Pesquisadas e Avaliadas

Nesta sprint, a equipe realizou uma pesquisa aprofundada e uma an√°lise comparativa de ferramentas *open-source* em quatro categorias distintas para compor um arsenal de seguran√ßa coeso. O objetivo foi avaliar as melhores op√ß√µes para cada camada de defesa do nosso pipeline de CI/CD.

* **Detec√ß√£o de Segredos (Secrets Detection)**
    * **Gitleaks:** Scanner r√°pido baseado em regras para encontrar credenciais e chaves de API expostas no c√≥digo.
    * **TruffleHog:** Ferramenta de an√°lise profunda que busca segredos com base em regras e na entropia dos dados.

* **An√°lise Est√°tica de Seguran√ßa (SAST)**
    * **Bandit:** Analisador focado em encontrar vulnerabilidades comuns e de baixo n√≠vel em c√≥digo Python.
    * **Semgrep:** Motor de an√°lise de c√≥digo moderno e flex√≠vel, com uma vasta base de regras para frameworks web como o Django, capaz de encontrar vulnerabilidades complexas.

* **An√°lise de Composi√ß√£o de Software (SCA)**
    * **pip-audit:** Ferramenta oficial do ecossistema Python que verifica depend√™ncias contra a base de dados de vulnerabilidades aberta (OSV).
    * **Safety:** Ferramenta tradicional que verifica depend√™ncias contra sua pr√≥pria base de dados de vulnerabilidades.

* **Seguran√ßa de Infraestrutura como C√≥digo (IaC)**
    * **Trivy:** Scanner multifuncional que analisa `Dockerfiles` em busca de m√°s pr√°ticas de seguran√ßa.
    * **Checkov:** Ferramenta especializada em IaC com uma cobertura extensiva de pol√≠ticas de seguran√ßa para diversas plataformas.


      A tabela a seguir consolida os resultados desta pesquisa, comparando as principais ferramentas open-source para cada categoria com base em sua funcionalidade, vantagens, desvantagens e, crucialmente, seu fator decisivo para a integra√ß√£o em nosso pipeline.

### Tabela Comparativa de Ferramentas de Seguran√ßa

| Categoria | Ferramenta | Breve Descri√ß√£o | Compara√ß√£o (Fator Decisivo) |
| :--- | :--- | :--- | :--- |
| **Detec√ß√£o de Segredos** | [Gitleaks](https://github.com/gitleaks/gitleaks) | Scanner r√°pido que busca segredos e credenciais em reposit√≥rios Git, utilizando uma base de regras de express√µes regulares. | **Melhor para CI/CD:** √â extremamente r√°pido e leve por ser um bin√°rio √∫nico (escrito em Go). Sua simplicidade o torna ideal para ser executado a cada `push` sem impactar a velocidade do pipeline. √â o padr√£o da ind√∫stria para preven√ß√£o r√°pida. |
| **Detec√ß√£o de Segredos** | [TruffleHog](https://github.com/trufflesecurity/trufflehog) | Scanner profundo que vai al√©m de regras, analisando a entropia dos dados para encontrar chaves com formatos desconhecidos. | **Melhor para Auditorias Profundas:** Sua capacidade de encontrar segredos com base na aleatoriedade (entropia) √© mais poderosa, mas o torna significativamente mais lento. √â uma ferramenta excelente para uma varredura completa e peri√≥dica, mas menos ideal para o pipeline do dia a dia. |
| **SAST** | [Bandit](https://github.com/PyCQA/bandit) | Ferramenta de SAST focada em encontrar problemas de seguran√ßa comuns em c√≥digo Python, analisando a √Årvore de Sintaxe Abstrata (AST). | **Melhor para Simplicidade em Python:** √â uma ferramenta "cl√°ssica", muito simples de rodar (`pip install` e executar). Seu foco exclusivo em Python garante uma boa detec√ß√£o de erros comuns no ecossistema (ex: uso de `pickle`, senhas fixas no c√≥digo). |
| **SAST** | [Semgrep](https://github.com/semgrep/semgrep) | Motor de an√°lise de c√≥digo moderno e multil√≠ngue com uma sintaxe de regras poderosa e intuitiva. | **Melhor em Poder e Flexibilidade:** √â a evolu√ß√£o do SAST. Suas regras s√£o mais f√°ceis de entender e customizar. A enorme base de regras da comunidade e a capacidade de se adaptar a qualquer padr√£o de c√≥digo o tornam mais poderoso e "√† prova de futuro" que o Bandit. |
| **SCA** | [pip-audit](https://github.com/pypa/pip-audit) | Ferramenta que escaneia as depend√™ncias do projeto em busca de vulnerabilidades, utilizando o banco de dados aberto e de alta qualidade OSV (Open Source Vulnerability). | **Melhor por usar um Padr√£o Aberto:** Sendo da PyPA (a mesma autoridade que cuida do `pip`), usa o banco de dados OSV, que √© um padr√£o da ind√∫stria mantido pelo Google. Isso garante dados de vulnerabilidade transparentes e de alta qualidade, sem restri√ß√µes comerciais. |
| **SCA** | [Safety](https://github.com/pyupio/safety) | Uma das ferramentas de SCA mais conhecidas para Python, que verifica as depend√™ncias instaladas contra seu pr√≥prio banco de dados de vulnerabilidades (Safety-DB). | **Modelo Comercial:** Sua principal desvantagem √© que a base de dados gratuita tem um atraso deliberado de 30 dias na divulga√ß√£o de novas vulnerabilidades, incentivando a assinatura da vers√£o paga. Para um projeto acad√™mico, o `pip-audit` √© uma escolha mais alinhada. |
| **IaC** | [Trivy](https://github.com/aquasecurity/trivy) | Scanner de vulnerabilidades multifuncional. Al√©m de imagens de cont√™ineres, ele tamb√©m consegue escanear arquivos de configura√ß√£o (como `Dockerfile` e `docker-compose.yml`) em busca de m√°s pr√°ticas. | **Melhor pela Consolida√ß√£o de Ferramentas:** A grande vantagem √© que poderemos usar a **mesma ferramenta** para escanear tanto a nossa IaC (Dockerfile) quanto as imagens Docker em uma sprint futura. Isso reduz a complexidade do pipeline e o n√∫mero de ferramentas para aprender. |
| **IaC** | [Checkov](https://github.com/bridgecrewio/checkov) | Ferramenta especializada em IaC que verifica arquivos de configura√ß√£o contra centenas de pol√≠ticas de seguran√ßa e boas pr√°ticas. | **Melhor em Cobertura Espec√≠fica para IaC:** √â mais poderoso e tem uma quantidade maior de regras *espec√≠ficas* para IaC do que o Trivy. √â a escolha de especialistas em nuvem, mas talvez seja um exagero para o nosso escopo, que se limita a Dockerfiles e Docker Compose. |

### Implementa√ß√£o do pip-audit - Seguran√ßa de Depend√™ncias


#### Como o pip-audit funciona

O pip-audit opera atrav√©s de um processo simples mas eficaz:
1. Coleta todas as depend√™ncias do projeto
2. Consulta o banco de dados OSV (Open Source Vulnerability) mantido pelo Google
3. Compara as vers√µes das depend√™ncias com vulnerabilidades conhecidas
4. Gera um relat√≥rio claro indicando quais pacotes necessitam de atualiza√ß√£o

#### Nossa Implementa√ß√£o no EJ-Platform

**Desafio t√©cnico:** O projeto EJ-Platform utiliza Poetry como gerenciador de depend√™ncias, enquanto o pip-audit tradicionalmente trabalha com arquivos requirements.txt. Foi necess√°rio desenvolver uma solu√ß√£o de integra√ß√£o entre os dois sistemas.

**Solu√ß√£o implementada:**
```yaml
dependency-audit:
  stage: security
  image: python:3.11-slim
  script:
    - pip install pip-audit
    - pip install "poetry==1.8.3"
    - poetry export -f requirements.txt --output requirements.txt --without-hashes
    - pip-audit -r requirements.txt --format=columns
  allow_failure: false
```


**Implementa√ß√£o Pr√°tica:**

(COLOCAR O QUE FOI IMPLEMENTADO NA PRATICA)

**Documenta√ß√£o Produzida:**

(REFERENCIAR OS DOCUMENTOS QUE FORAM PRODUZIDOS)

##### Exemplo de pipeline:

- C√≥digo usado na pipeline.

![Pipeline-gitleaks](../imgs/git-leaks-pipe-Daniel.png)

- Fluxo da pipeline.

![Fluxo](../imgs/fluxo-resultante-daniel.png)

-----

##### Fluxo resultante

![Resultado](../imgs/terminal-pipeline-resultado-daniel.png)

Como esperado, a pipeline se encerrou com erro, analisando 53 commits e identificando 52 leaks

- Job de (COLOCAR A FERRAMENTA QUE FOI IMPLEMENTADA).

![Job]()

![Job-detalhes]()



### Red Team

#### Ataque sobre SQL Injection

Foi utilizado a ferramenta [BurpSuite Community Edition](https://portswigger.net/burp) para a obten√ß√£o das URLs de requisi√ß√µes GET e POST, na aba *Proxy/Intercept*, clicando na op√ß√£o de abrir Browser, que ir√° abrir um browser Chromium normal, a partir dele entrei na conta fake de testes como usu√°rio (user@user.com) presente no banco de dados postgres atrav√©s do comando `inv docker-exec 'inv db-fake'` e realizei a√ß√µes comuns do usu√°rio como criar um dashboard, personas, alterar informa√ß√µes do usu√°rio logado, etc.

O [BurpSuite](https://portswigger.net/burp) manteve um hist√≥rico de todas as requisi√ß√µes feitas nesta sess√£o na aba *Proxy/HTTP History*, foi selecionado todas as requisi√ß√µes desse hist√≥rico e salvo em um arquivo xml que ser√° passado como argumento para o [SQLMap](https://sqlmap.org/)

Para o teste de fato foi utilizado a ferramenta [SQLMap](https://sqlmap.org/), muito utilizada para ataques de SQL Injection com muitas op√ß√µes avan√ßadas e suporte a v√°rios banco de dados (Oracle, Postgres, MySQL, etc), foi executado o seguinte comando:

`sqlmap -l burg_log.xml --batch --level 5 --risk 3 --dbms postgres`

- `-l`: Comando especifico para obter alvos atrav√©s de um arquivo log do BurpSuite ou WebScarab
- `burg_log.xml`: Arquivo de log obtido atrav√©s do Proxy do BurpSuite
- `--batch`: N√£o perguntar por confirma√ß√µes e selecionar as op√ß√µes padr√µes
- `--level 5`: N√≠vel m√°ximo de quantidade de testes a serem realizados
- `--risk 3`: N√≠vel de risco m√°ximo, com alta chance de ser detectado (n√£o √© importante neste caso)
- `--dbms postgres`: Informa o SQLMap para usar apenas scripts especificos para postgres, usado na EJ Application, se n√£o informado o [SQLMap](https://sqlmap.org/) ir√° tentar scripts de v√°rios banco de dados diferentes como Oracle, MySQL e outros.

N√£o foram encontrados pontos de falha SQL Injection utilizando [SQLMap](https://sqlmap.org/), apesar de ele ter encontrado alguns falsos positivos: 

- Em localhost/boards/teste/conversations/add/ usando SQL Injection no User-Agent com t√©cnicas boolean blind based
- Em localhost/boards/teste/conversations usando SQL Injection no Cookie de sessionid com t√©cnicas boolean blind based

Esses falsos positivos foram identificados com a t√©cnica de boolean blind based que injeta scripts SQL em objetos dentro da requisi√ß√£o e espera uma resposta diferente da padr√£o, se houve uma resposta diferente ent√£o o ataque √© considerado bem sucedido, mas isso pode ocorrer quando uma p√°gina possu√≠ elementos din√¢micos, provavelmente o [SQLMap](https://sqlmap.org/) verificou que a p√°gina mudou, mas ao tentar fazer um exploit (acesso ao banco de dados ou obter informa√ß√µes) atrav√©s desta t√©cnica ele n√£o teve resultados.

```
Target URL,Place,Parameter,Technique(s),Note(s)
http://10.0.0.5:8000/boards/teste/conversations/,Cookie,sessionid,B,false positive or unexploitable
http://10.0.0.5:8000/boards/teste/conversations/add/,User-Agent,User-Agent,B,false positive or unexploitable
```

V√≠deo de demonstra√ß√£o: 
<iframe width="1310" height="737" src="https://www.youtube.com/embed/QMBZJynQwfU" title="EJ Application Teste SQL Injection" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

#### Ataque sobre XSS (Vulnerabilidade Encontrada)

* **Tipo de vulnerabilidade:** XSS Persistente (Stored XSS).
* **Localiza√ß√£o:** Campos Rich Text. O conte√∫do salvo √© posteriormente renderizado no navegador sem escaping adequado.
* **Causa raiz:** Falta de sanitiza√ß√£o no backend + renderiza√ß√£o com flags que desabilitam escaping, permitindo que conte√∫do armazenado seja interpretado como c√≥digo no cliente.
* **Evid√™ncia:** Conte√∫do malicioso foi persistido no banco e provoca execu√ß√£o de script quando a p√°gina afetada √© carregada por um usu√°rio. (passos e payloads foram removidos deste documento).
* **Impacto potencial:** Roubo de cookies de sess√£o, execu√ß√£o de a√ß√µes em nome do usu√°rio, manipula√ß√£o de feedbacks/entradas, redirecionamentos e degrada√ß√£o da confian√ßa na plataforma.
* **Recomenda√ß√µes:**
    * Implementar sanitiza√ß√£o server-side robusta para entradas Rich Text (usar bibliotecas maduras e listas de permiss√£o de tags/atributos).
    * Evitar uso irrestrito de flags que desabilitem escaping; garantir que qualquer conte√∫do marcado como seguro seja validado e sanitizado.

Link: [Relat√≥rio Completo de Reprodu√ß√£o e An√°lise da Vulnerabilidade](https://unbbr-my.sharepoint.com/:b:/g/personal/221008703_aluno_unb_br/ESkTAolLP5ZHqdUQFBZEjyAB9DxryON9Fn3o2vW0_7rRzA)

**Obs:** O relat√≥rio completo √© um arquivo privado no OneDrive e, at√© o momento, s√≥ est√° liberado para a professora da disciplina.

#### Ataque sobre CSRF
**O que √© CSRF (Cross-Site Request Forgery)**

CSRF √© uma t√©cnica de ataque em que um site malicioso faz com que o **navegador de uma v√≠tima autenticada** envie requisi√ß√µes indesejadas a um site confi√°vel onde a v√≠tima j√° possui sess√£o ativa. O atacante explora o fato de que **cookies e outras credenciais gerenciadas automaticamente pelo navegador** s√£o inclu√≠das em requisi√ß√µes originadas do contexto do usu√°rio.

**Cen√°rio de teste descrito**

1. **Testar via p√°gina HTML separada** ‚Äî Foi criado um arquivo HTML que tenta enviar um POST para `http://localhost:8000/api/v1/votes/` a partir do mesmo navegador onde est√° logado como admin. Ao submeter a requisi√ß√£o pelo HTML, o servidor respondeu com `401 Unauthorized` e o JSON `{"detail": "Credenciais de autentica√ß√£o n√£o foram fornecidas."}`.

**Sa√≠da observada**

```
Vote List
POST /api/v1/votes/
HTTP 401 Unauthorized
Allow: GET, POST, HEAD, OPTIONS
Content-Type: application/json
Vary: Accept
WWW-Authenticate: Bearer realm="api"

{
    "detail": "Credenciais de autentica√ß√£o n√£o foram fornecidas."
}
```

- O comportamento indica que o endpoint **exige um header `Authorization: Bearer <token>`** para autentica√ß√£o, ou outro esquema que n√£o √© enviado automaticamente pelo navegador quando a requisi√ß√£o √© iniciada de outro site.
- Quando a requisi√ß√£o foi disparada a partir do HTML externo, **o navegador n√£o enviou qualquer credencial** (nem cookie de sess√£o nem header Authorization), logo o servidor respondeu `401`.
- Isso **implica** que o mecanismo de autentica√ß√£o atual **n√£o √© baseado em cookies de sess√£o enviados automaticamente**. Como resultado, o vetor cl√°ssico de CSRF **falhou**.

#### Ataque sobre Clickjacking

* **Tipo de vulnerabilidade:** Clickjacking (UI Redress Attack).  
* **Localiza√ß√£o:** P√°ginas p√∫blicas e autenticadas da aplica√ß√£o EJ (testes realizados no endpoint `/login` e em outras rotas acess√≠veis sem prote√ß√£o de cabe√ßalhos).  
* **Causa raiz:** Aus√™ncia dos cabe√ßalhos de seguran√ßa `X-Frame-Options` e `Content-Security-Policy: frame-ancestors`, o que permite que a aplica√ß√£o seja embutida dentro de um `<iframe>` externo.  
* **Descri√ß√£o do ataque:**  
  O atacante pode criar uma p√°gina maliciosa contendo um `iframe` invis√≠vel ou semitransparente que carrega a aplica√ß√£o leg√≠tima. Sobre este `iframe`, ele posiciona elementos visuais falsos (ex.: "Clique aqui para ganhar um pr√™mio"). Quando o usu√°rio clica nesses elementos, o clique √© redirecionado para o bot√£o real da aplica√ß√£o ‚Äî por exemplo, um bot√£o de login, confirma√ß√£o ou envio ‚Äî sem o conhecimento do usu√°rio.  

* **Prova de Conceito (PoC):**  
  Foi criado o arquivo `poc.html` contendo um iframe apontando para a p√°gina de login da EJ Application: [Relat√≥rio Completo de ataque clickjacking](https://www.overleaf.com/project/68e580a087a88333ae844f6e)

### **Ataque sobre IDOR (Insecure Direct Object Reference)**

#### O que √© IDOR?

*IDOR (Insecure Direct Object Reference)* √© uma falha de controle de acesso onde um *site permite que um usu√°rio acesse ou modifique dados que n√£o pertencem a ele*, simplesmente ao manipular o valor de um identificador (ID) em uma requisi√ß√£o, como um n√∫mero na URL. Se a aplica√ß√£o n√£o verificar se o usu√°rio logado tem permiss√£o para acessar o objeto com aquele ID, a vulnerabilidade existe.

#### Cen√°rio de teste descrito

1.  **Prepara√ß√£o** ‚Äî Foi feito o login como `admin@admin.com` para acessar o painel de administra√ß√£o (`/admin/`) e descobrir o ID num√©rico de usu√°rios.
2.  **Teste** ‚Äî Em um navegador separado (janela an√¥nima), foi feito o login como um usu√°rio comum (`user@user.com`). Em seguida, foi feita uma tentativa de acesso direto ao perfil do admin, for√ßando a URL para `http://localhost:8000/users/34/`.
3.  **Resultado** ‚Äî O servidor respondeu com um erro **`404 Page not found`**.

#### Sa√≠da observada

A aplica√ß√£o retornou a p√°gina de erro padr√£o do Django, indicando que a rota solicitada n√£o existe. A lista de URLs v√°lidas exibida na p√°gina de erro confirmou que n√£o h√° um padr√£o de URL no formato `/users/<ID>/`.

* E esse comportamento indica que a aplica√ß√£o n√£o exp√µe perfis de usu√°rio atrav√©s de uma URL direta com o ID num√©rico.
* Como a rota n√£o existe, o resultado pr√°tico √© que este vetor de ataque espec√≠fico de IDOR n√£o √© explor√°vel.

### **Ataque sobre Sess√µes / Cookies Inseguros**

#### O que s√£o Sess√µes / Cookies Inseguros?

Refere-se a falhas no gerenciamento do cookie que identifica a sess√£o de um usu√°rio logado. Se o cookie n√£o for configurado com atributos de seguran√ßa (flags), ele pode ser interceptado em redes inseguras ou roubado por scripts maliciosos.

#### Cen√°rio de teste descrito

1.  **Prepara√ß√£o** ‚Äî Foi feito o login na aplica√ß√£o com um usu√°rio.
2.  **Teste** ‚Äî Utilizando as Ferramentas de Desenvolvedor do navegador (`F12`), a aba `Application` (ou `Storage`) foi usada para inspecionar os cookies do site.
3.  **Resultado** ‚Äî O cookie `sessionid` foi localizado e seus atributos de seguran√ßa foram analisados.

#### Sa√≠da observada

A inspe√ß√£o do cookie `sessionid` revelou os seguintes atributos:
* **`HttpOnly`**: `True`
* **`Secure`**: `False`
* **`SameSite`**: `Lax`

* O comportamento indica que o cookie de sess√£o est√° corretamente protegido contra leitura por scripts JavaScript (gra√ßas √† flag **`HttpOnly`**).
* A flag **`SameSite=Lax`** tamb√©m √© uma boa configura√ß√£o padr√£o, oferecendo prote√ß√£o contra ataques de CSRF.
* No entanto, a flag **`Secure`** est√° ausente. Isso implica que, em um ambiente de produ√ß√£o real com HTTPS, o cookie poderia ser interceptado, representando uma vulnerabilidade.

### **Ataque sobre Brute Force e Rate Limiting**

* **Tipo de vulnerabilidade:** Brute Force Attack / Aus√™ncia de Rate Limiting.
* **Localiza√ß√£o:** Endpoints de autentica√ß√£o, formul√°rios de login, APIs de reset de senha, endpoints de valida√ß√£o OTP/2FA e qualquer ponto de entrada que aceite credenciais de usu√°rio.
* **Causa raiz:** Falta de implementa√ß√£o adequada de mecanismos de rate limiting e controles de seguran√ßa que limitam o n√∫mero de tentativas de autentica√ß√£o por usu√°rio, IP ou sess√£o dentro de um per√≠odo espec√≠fico de tempo.

#### **Descri√ß√£o do ataque:**
  
  Ataques de brute force s√£o m√©todos sistem√°ticos onde atacantes utilizam ferramentas automatizadas para tentar m√∫ltiplas combina√ß√µes de credenciais at√© encontrar as corretas. Este tipo de ataque pode se manifestar de v√°rias formas:

  - **Traditional Brute Force**: Tentativas autom√°ticas de m√∫ltiplas senhas contra um usu√°rio conhecido
  - **Dictionary Attacks**: Uso de listas de senhas comuns e varia√ß√µes baseadas em pesquisa do alvo
  - **Credential Stuffing**: Utiliza√ß√£o de combina√ß√µes usu√°rio/senha obtidas de vazamentos de outros sites
  - **Password Spraying**: Teste de uma senha fraca contra m√∫ltiplas contas diferentes

#### **Ferramentas comumente utilizadas:**
  - **Hydra (THC-Hydra)**: Cracking de autentica√ß√£o de rede via brute force, suporta mais de 30 protocolos
  - **John the Ripper**: Ferramenta cl√°ssica que combina m√∫ltiplas funcionalidades de quebra de senha
  - **Burp Suite**: Suite de testes de seguran√ßa web com m√≥dulo Intruder para ataques automatizados
  - **Hashcat**: Cracking de senhas acelerado por GPU, capaz de testar milh√µes de combina√ß√µes por segundo
  - **Patator**: Ferramenta multi-prop√≥sito para brute force em FTP, SSH, SMTP, RDP e outros protocolos

#### **T√©cnicas de bypass de rate limiting:**
  - **Manipula√ß√£o de headers**: Altera√ß√£o de `X-Forwarded-For`, `X-Originating-IP`, `User-Agent`
  - **Rota√ß√£o de endpoints**: Uso de varia√ß√µes como `/login`, `/Login`, `/LOGIN`
  - **Uso de caracteres especiais**: Inser√ß√£o de bytes nulos (`%00`, `%0d%0a`, `%20`) em par√¢metros
  - **Distribui√ß√£o via proxies**: Uso de redes Tor, VPNs ou botnets para distribuir requisi√ß√µes
  - **Race conditions**: Explora√ß√£o de condi√ß√µes de corrida para enviar m√∫ltiplas requisi√ß√µes simultaneamente

#### **Exemplo de implementa√ß√£o:**

```
# Exemplo de rate limiting simples em Flask
from flask_limiter import Limiter
from flask_limiter.util import get_remote_address

limiter = Limiter(
    app,
    key_func=get_remote_address,
    default_limits=["200 per day", "50 per hour"]
)

@app.route('/login', methods=['POST'])
@limiter.limit("5 per minute")
def login():
    # L√≥gica de autentica√ß√£o
    pass
```

---

## 5. Maiores Dificuldades

* Houve dificuldade de acesso √† aplica√ß√£o Docker via Kali Linux, resolvida ao incluir o IP local da m√°quina host em `DJANGO_ALLOWED_HOSTS`.
* Houve dificuldade em gerenciar duas sess√µes simult√¢neas para testes de IDOR (foi necess√°rio usar navegadores/perfis distintos).
* Houve dificuldade em contornar a sanitiza√ß√£o de entradas da API para explorar vulnerabilidades XSS, pois os endpoints estavam bem protegidos, tornando complexo identificar pontos suscet√≠veis a ataques.
* Configura√ß√£o inicial dos forks do projeto e entendimento da estrutura complexa do pipeline GitLab.
* Integra√ß√£o de ferramentas de seguran√ßa (Gitleaks, Bandit) no fluxo CI/CD existente.

---

## 6. Li√ß√µes Aprendidas

* Utiliza√ß√£o de sqlmap e BurpSuite para testes de inje√ß√£o e proxy de requisi√ß√µes.
* Sanitiza√ß√£o server-side √© obrigat√≥ria, mesmo com valida√ß√µes client-side.
* Rich Text com renderiza√ß√£o sem escape aumenta risco de XSS persistente.
* Ferramentas automatizadas (ex.: sqlmap) ajudam na triagem; an√°lise manual ainda √© necess√°ria.
* Dom√≠nio completo dos conceitos de CI/CD e estrutura√ß√£o de pipelines GitLab.
* Import√¢ncia da integra√ß√£o de ferramentas de seguran√ßa no ciclo de desenvolvimento.
* Configura√ß√£o adequada de atributos de seguran√ßa em cookies √© crucial para prote√ß√£o.

---

## 7. Planejamento para a Pr√≥xima Sprint

### Blue Team

* Implementar ferramentas de seguran√ßa no pipeline CI/CD do projeto
* Configurar Gitleaks e Bandit no fluxo de integra√ß√£o cont√≠nua
* Desenvolver pol√≠ticas de seguran√ßa para c√≥digo e depend√™ncias
* Criar monitoramento cont√≠nuo de vulnerabilidades

### Red Team

* Explorar Ataques:
    * IDOR
    * Sess√£o (Cookies)
    * Rate-limit / Fuzzing
* Simular phishing no contexto da plataforma
